<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Color Changer Component</title>
</head>
<body>
<!-- Use the custom element -->
<color-changer></color-changer>

<script>
    class ColorChanger extends HTMLElement {
        constructor() {
            super();
            // Attach an open shadow DOM for encapsulation
            this.attachShadow({ mode: 'open' });
        }

        connectedCallback() {
            // Define the component's template with styles and markup
            this.shadowRoot.innerHTML = `
            <style>
              :host {
                display: block;
                padding: 1rem;
                border: 1px solid #ccc;
                text-align: center;
                border-radius: 5px;
                transition: background-color 0.5s ease;
              }
              button {
                padding: 0.5rem 1rem;
                font-size: 1rem;
              }
              .color-value {
                font-weight: bold;
              }
            </style>
            <div>
              <button id="changeColorBtn">Change Color</button>
              <p>Current Color: <span class="color-value">#ffffff</span></p>
            </div>
          `;

            // Store references to DOM elements for later use
            this._colorDisplay = this.shadowRoot.querySelector('.color-value');
            this._button = this.shadowRoot.querySelector('#changeColorBtn');

            // Attach an event listener to handle the color change on click
            this._button.addEventListener('click', () => this.changeColor());
        }

        disconnectedCallback() {
            // Clean up the event listener when the element is removed
            this._button.removeEventListener('click', () => this.changeColor());
        }

        changeColor() {
            // Generate a random hex color ensuring it's 6 digits
            const randomColor =
                '#' +
                Math.floor(Math.random() * 16777215)
                    .toString(16)
                    .padStart(6, '0');

            // Update the background color of the host element
            this.style.backgroundColor = randomColor;

            // Update the text within the component to show the new color value
            if (this._colorDisplay) {
                this._colorDisplay.textContent = randomColor;
            }
        }
    }

    // Define the custom element
    customElements.define('color-changer', ColorChanger);
</script>
</body>
</html>
